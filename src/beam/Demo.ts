import { Engine } from '../engine/Engine'
import * as THREE from 'three'
import { Beam } from './Beam'
import { Experience } from '../engine/Experience'
import { Resource } from '../engine/Resources'

export class Demo implements Experience {
  resources: Resource[] = []
  currTex: number = 0;
  textureNames = [
    'p00_f049920000',
    'p00_f110080000',
    'p00_f327680000',
    'p02_f049920000',
    'p02_f051200000',
    'p02_f052480000',
    'p02_f053760000',
    'p02_f055040000',
    'p02_f056320000',
    'p02_f057600000',
    'p02_f058880000',
    'p02_f060160000',
    'p02_f061440000',
    'p02_f062720000',
    'p02_f064000000',
    'p02_f065280000',
    'p02_f066560000',
    'p02_f067840000',
    'p02_f069120000',
    'p02_f070400000',
    'p02_f071680000',
    'p02_f072960000',
    'p02_f074240000',
    'p02_f075520000',
    'p02_f076800000',
    'p02_f078080000',
    'p02_f079360000',
    'p02_f080640000',
    'p02_f081920000',
    'p02_f083200000',
    'p02_f084480000',
    'p02_f085760000',
    'p02_f087040000',
    'p02_f088320000',
    'p02_f089600000',
    'p02_f090880000',
    'p02_f092160000',
    'p02_f093440000',
    'p02_f094720000',
    'p02_f096000000',
    'p02_f097280000',
    'p02_f098560000',
    'p02_f099840000',
    'p02_f101120000',
    'p02_f102400000',
    'p02_f103680000',
    'p02_f104960000',
    'p02_f106240000',
    'p02_f107520000',
    'p02_f108800000',
    'p02_f110080000',
    'p02_f111360000',
    'p02_f112640000',
    'p02_f113920000',
    'p02_f115200000',
    'p02_f116480000',
    'p02_f117760000',
    'p02_f119040000',
    'p02_f120320000',
    'p02_f121600000',
    'p02_f122880000',
    'p02_f124160000',
    'p02_f125440000',
    'p02_f126720000',
    'p02_f128000000',
    'p02_f129280000',
    'p02_f130560000',
    'p02_f131840000',
    'p02_f133120000',
    'p02_f134400000',
    'p02_f135680000',
    'p02_f136960000',
    'p02_f138240000',
    'p02_f139520000',
    'p02_f140800000',
    'p02_f142080000',
    'p02_f143360000',
    'p02_f144640000',
    'p02_f145920000',
    'p02_f147200000',
    'p02_f148480000',
    'p02_f149760000',
    'p02_f151040000',
    'p02_f152320000',
    'p02_f153600000',
    'p02_f154880000',
    'p02_f156160000',
    'p02_f157440000',
    'p02_f158720000',
    'p02_f160000000',
    'p02_f161280000',
    'p02_f162560000',
    'p02_f163840000',
    'p02_f165120000',
    'p02_f166400000',
    'p02_f167680000',
    'p02_f168960000',
    'p02_f170240000',
    'p02_f171520000',
    'p02_f172800000',
    'p02_f174080000',
    'p02_f175360000',
    'p02_f176640000',
    'p02_f177920000',
    'p02_f179200000',
    'p02_f180480000',
    'p02_f181760000',
    'p02_f183040000',
    'p02_f184320000',
    'p02_f185600000',
    'p02_f186880000',
    'p02_f188160000',
    'p02_f189440000',
    'p02_f190720000',
    'p02_f192000000',
    'p02_f193280000',
    'p02_f194560000',
    'p02_f195840000',
    'p02_f197120000',
    'p02_f198400000',
    'p02_f199680000',
    'p02_f200960000',
    'p02_f202240000',
    'p02_f203520000',
    'p02_f204800000',
    'p02_f206080000',
    'p02_f207360000',
    'p02_f208640000',
    'p02_f209920000',
    'p02_f211200000',
    'p02_f212480000',
    'p02_f213760000',
    'p02_f215040000',
    'p02_f216320000',
    'p02_f217600000',
    'p02_f218880000',
    'p02_f220160000',
    'p02_f221440000',
    'p02_f222720000',
    'p02_f224000000',
    'p02_f225280000',
    'p02_f226560000',
    'p02_f227840000',
    'p02_f229120000',
    'p02_f230400000',
    'p02_f231680000',
    'p02_f232960000',
    'p02_f234240000',
    'p02_f235520000',
    'p02_f236800000',
    'p02_f238080000',
    'p02_f239360000',
    'p02_f240640000',
    'p02_f241920000',
    'p02_f243200000',
    'p02_f244480000',
    'p02_f245760000',
    'p02_f247040000',
    'p02_f248320000',
    'p02_f249600000',
    'p02_f250880000',
    'p02_f252160000',
    'p02_f253440000',
    'p02_f254720000',
    'p02_f256000000',
    'p02_f257280000',
    'p02_f258560000',
    'p02_f259840000',
    'p02_f261120000',
    'p02_f262400000',
    'p02_f263680000',
    'p02_f264960000',
    'p02_f266240000',
    'p02_f267520000',
    'p02_f268800000',
    'p02_f270080000',
    'p02_f271360000',
    'p02_f272640000',
    'p02_f273920000',
    'p02_f275200000',
    'p02_f276480000',
    'p02_f277760000',
    'p02_f279040000',
    'p02_f280320000',
    'p02_f281600000',
    'p02_f282880000',
    'p02_f284160000',
    'p02_f285440000',
    'p02_f286720000',
    'p02_f288000000',
    'p02_f289280000',
    'p02_f290560000',
    'p02_f291840000',
    'p02_f293120000',
    'p02_f294400000',
    'p02_f295680000',
    'p02_f296960000',
    'p02_f298240000',
    'p02_f299520000',
    'p02_f300800000',
    'p02_f302080000',
    'p02_f303360000',
    'p02_f304640000',
    'p02_f305920000',
    'p02_f307200000',
    'p02_f308480000',
    'p02_f309760000',
    'p02_f311040000',
    'p02_f312320000',
    'p02_f313600000',
    'p02_f314880000',
    'p02_f316160000',
    'p02_f317440000',
    'p02_f318720000',
    'p02_f320000000',
    'p02_f321280000',
    'p02_f322560000',
    'p02_f323840000',
    'p02_f325120000',
    'p02_f326400000',
    'p02_f327680000',
  ]

  constructor(private engine: Engine) {
    this.textureNames.forEach((name) => {
      this.resources.push({
        name,
        type: 'texture',
        path: `textures/beam_texture_${name}.png`
      })
    })
    engine.debug.gui.show();
    engine.debug.gui.add(this, 'currTex', 0, this.textureNames.length - 1).onChange((idx: number) => {
      const name = this.textureNames[Math.floor(idx)]
      if (name !== undefined) {
        this.engine.scene.traverse( (child)=>{
          if(child instanceof Beam) {
            child.updateTex(this.engine.resources.getItem(name) as THREE.Texture)
          }
        })
      }
    })
  }

  init() {
    // const plane = new THREE.Mesh(
    //   new THREE.PlaneGeometry(10, 10),
    //   new THREE.MeshStandardMaterial({ color: 0xffffff })
    // )

    // plane.rotation.x = -Math.PI / 2
    // plane.receiveShadow = true

    // this.engine.scene.add(plane)
    this.engine.scene.add(new THREE.AmbientLight(0xffffff, 0.5))

    let directionalLight = new THREE.DirectionalLight(0xffffff, 1)
    directionalLight.castShadow = true
    directionalLight.position.set(2, 2, 2)

    this.engine.scene.add(directionalLight)

    const sphere = new Beam()
    sphere.castShadow = true
    sphere.rotation.y = Math.PI / 4
    sphere.position.set(0, -1, 0)

    this.engine.scene.add(sphere)
  }

  resize() {}

  update() {}
}
